!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.driver=t():e.driver=t()}(global,(()=>(()=>{var e={575:(e,t,a)=>{let l=a(893),s=[3,[{taglbl:0,resol:1,sampletype:7,lblname:"temperature",divide:100},{taglbl:1,resol:1,sampletype:6,lblname:"humidity",divide:100},{taglbl:2,resol:1,sampletype:7,lblname:"pressure",divide:1},{taglbl:3,resol:1,sampletype:10,lblname:"index_1",divide:1},{taglbl:4,resol:1,sampletype:10,lblname:"index_2",divide:1},{taglbl:5,resol:1,sampletype:6,lblname:"battery_voltage",divide:1e3}]];e.exports.decodeUplink=function(e){return result=l.watteco_decodeUplink(e,s)}},769:e=>{let t=3,a=4,l=5,s=6,d=7,i=9,r=10,n=12,o={0:0,1:1,2:4};o[t]=4,o[a]=8,o[l]=8,o[s]=16,o[d]=16,o[8]=24,o[i]=24,o[r]=32,o[11]=32,o[n]=32;let u=14,m=16,_=[[{sz:2,lbl:0},{sz:2,lbl:1},{sz:2,lbl:3},{sz:3,lbl:5},{sz:4,lbl:9},{sz:5,lbl:17},{sz:6,lbl:33},{sz:7,lbl:65},{sz:8,lbl:129},{sz:10,lbl:512},{sz:11,lbl:1026},{sz:11,lbl:1027},{sz:11,lbl:1028},{sz:11,lbl:1029},{sz:11,lbl:1030},{sz:11,lbl:1031}],[{sz:7,lbl:111},{sz:5,lbl:26},{sz:4,lbl:12},{sz:3,lbl:3},{sz:3,lbl:7},{sz:2,lbl:2},{sz:2,lbl:0},{sz:3,lbl:2},{sz:6,lbl:54},{sz:9,lbl:443},{sz:9,lbl:441},{sz:10,lbl:885},{sz:10,lbl:884},{sz:10,lbl:880},{sz:11,lbl:1763},{sz:11,lbl:1762}],[{sz:4,lbl:9},{sz:3,lbl:5},{sz:2,lbl:0},{sz:2,lbl:1},{sz:2,lbl:3},{sz:5,lbl:17},{sz:6,lbl:33},{sz:7,lbl:65},{sz:8,lbl:129},{sz:10,lbl:512},{sz:11,lbl:1026},{sz:11,lbl:1027},{sz:11,lbl:1028},{sz:11,lbl:1029},{sz:11,lbl:1030},{sz:11,lbl:1031}]];function p(e,s,p,h){let z=function(){let e=[],t=0;for(;t<m;)e.push({codingType:0,codingTable:0,resolution:null,uncompressSamples:[]}),t+=1;return{batch_counter:0,batch_relative_timestamp:0,series:e}}(),P=function(e){function a(e,t,a){let l=t,s=a-1;if(8*e.length<l+a)throw new Error("Batch : Verify that dest buf is large enough");let d=0,i=0;for(;a>0;)e[l>>3]&1<<(7&l)&&(i|=1<<s-d),a--,d++,l++;return i}return{i1:0,byteArray:e,getNextSample:function(e,a){let s=a||o[e],r=this.i1;if(this.i1+=s,e===n&&32!==s)throw new Error("Batch : Mauvais sampletype");let u=0,m=Math.trunc((s-1)/8)+1,_=s%8;for(0===_&&m>0&&(_=8);m>0;){let e=0;for(;_>0;){let t=r>>3;this.byteArray[t]&1<<(7&r)&&(u|=1<<8*(m-1)+e),_--,e++,r+=1}m--,_=8}if((e==t||e==l||e==d||e==i)&&u&1<<s-1)for(let e=s;e<32;e++)u|=1<<e,s++;return u},getNextBifromHi:function(e){for(let t=2;t<12;t++){let l=a(this.byteArray,this.i1,t);for(let a=0;a<_[e].length;a++)if(_[e][a].sz==t&&l==_[e][a].lbl)return this.i1+=t,a}throw new Error("Bi not found in HUFF table")}}}(function(e){var t=[];for(;e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}(p)),y=function(e){let t=e.toString(2);for(;t.length<8;)t="0"+t;return{isCommonTimestamp:parseInt(t[t.length-2],2),hasSample:!parseInt(t[t.length-3],2),batch_req:parseInt(t[t.length-4],2),nb_of_type_measure:parseInt(t.substring(0,4),2)}}(P.getNextSample(a));z.batch_counter=P.getNextSample(a,3),P.getNextSample(a,1);let E=function(e,t,l,s,d){let i=0,r=0;for(let n=0;n<s.nb_of_type_measure;n++){let o={size:d,lbl:t.getNextSample(a,d)},u=c(l,o);0===n&&(r=u),i=f(t,i),e.series[u]=b(t,l[u].sampletype,o.lbl,i),s.hasSample&&(e.series[u].codingType=t.getNextSample(a,2),e.series[u].codingTable=t.getNextSample(a,2))}return{last_timestamp:i,i1_of_the_first_sample:r}}(z,P,s,y,e),S=E.last_timestamp,I=E.i1_of_the_first_sample;return y.hasSample&&(S=function(e,t,l,s,d,i,n){return i.isCommonTimestamp?function(e,t,l,s,d,i){let n=t.getNextSample(a,8),o={},m=function(e,t,l,s){let d=[],i=0,n=t.getNextSample(a,2);for(let a=0;a<l;a++){let l=t.getNextBifromHi(n);if(l<=u)if(0===a)d.push(e.series[s].uncompressSamples[0].data_relative_timestamp);else if(l>0){let e=d[a-1];d.push(t.getNextSample(r,l)+e+Math.pow(2,l)-1)}else d.push(precedingTimestamp);else d.push(t.getNextSample(r));i=d[a]}return{timestampCommon:d,lastTimestamp:i}}(e,t,n,l),_=m.timestampCommon,p=m.lastTimestamp;for(let l=0;l<d.nb_of_type_measure;l++){let l=1;o.lbl=t.getNextSample(a,i);let d=c(s,o);for(let i=0;i<n;i++){if(t.getNextSample(a,1)){let a=t.getNextBifromHi(e.series[d].codingTable),r={data_relative_timestamp:0,data:{}};if(a<=u){let i=e.series[d].uncompressSamples[e.series[d].uncompressSamples.length-1].data.value;if(a>0)r.data.value=v(t,i,e.series[d].codingType,s[d].resol,a);else{if(l){l=0;continue}r.data.value=i}}else r.data.value=t.getNextSample(s[d].sampletype);r.data_relative_timestamp=_[i],e.series[d].uncompressSamples.push(r)}}}return p}(e,t,l,s,i,n):function(e,t,l,s,d,i){let r={};for(let n=0;n<d.nb_of_type_measure;n++){r.lbl=t.getNextSample(a,i);let d=c(l,r),n=t.getNextSample(a,8);if(n){let i=t.getNextSample(a,2);for(let a=0;a<n;a++){let a=e.series[d].uncompressSamples[e.series[d].uncompressSamples.length-1].data_relative_timestamp,r={data_relative_timestamp:0,data:{}},n=t.getNextBifromHi(i);if(r.data_relative_timestamp=g(t,a,n),r.data_relative_timestamp>s&&(s=r.data_relative_timestamp),n=t.getNextBifromHi(e.series[d].codingTable),n<=u){let a=e.series[d].uncompressSamples[e.series[d].uncompressSamples.length-1].data.value;r.data.value=n>0?v(t,a,e.series[d].codingType,l[d].resol,n):a}else r.data.value=t.getNextSample(l[d].sampletype);e.series[d].uncompressSamples.push(r)}}}return s}(e,t,s,d,i,n)}(z,P,I,s,S,y,e)),z.batch_relative_timestamp=f(P,S),function(e,t,a){let l={batch_counter:e.batch_counter,batch_relative_timestamp:e.batch_relative_timestamp};a&&(l.batch_absolute_timestamp=a);return l.dataset=e.series.reduce((function(l,s,d){return l.concat(s.uncompressSamples.map((function(l){let s={data_relative_timestamp:l.data_relative_timestamp,data:{value:t[d].divide?l.data.value/t[d].divide:l.data.value,label:t[d].taglbl}};var i,r,n;return t[d].lblname&&(s.data.label_name=t[d].lblname),a&&(s.data_absolute_timestamp=(i=a,r=e.batch_relative_timestamp,n=l.data_relative_timestamp,new Date(new Date(i)-1e3*(r-n)).toISOString())),s})))}),[]),l}(z,s,h)}function b(e,t,a,l){return{uncompressSamples:[{data_relative_timestamp:l,data:{value:h(e,t),label:a}}],codingType:0,codingTable:0,resolution:null}}function c(e,t){for(let a=0;a<e.length;a++)if(e[a].taglbl===t.lbl)return a;throw new Error("Batch : Cannot find i1 in argList")}function f(e,t){if(t){let a=e.getNextBifromHi(1);return g(e,t,a)}return e.getNextSample(r)}function g(e,t,a){return a>u?e.getNextSample(r):a>0?function(e,t,a){return e.getNextSample(r,a)+t+Math.pow(2,a)-1}(e,t,a):t}function h(e,t){let a=e.getNextSample(t);return t===n?function(e){let t=2147483648&e?-1:1,a=(e>>23&255)-127,l=8388607&e;if(128===a)return t*(l?Number.NaN:Number.POSITIVE_INFINITY);if(-127===a){if(0===l)return 0*t;a=-126,l/=1<<22}else l=(l|1<<23)/(1<<23);return t*l*Math.pow(2,a)}(a):a}function v(e,t,a,l,d){let i=e.getNextSample(s,d);return 0===a?function(e,t,a,l){return e>=Math.pow(2,l-1)?e*t+a:(e+1-Math.pow(2,l))*t+a}(i,l,t,d):1===a?(i+Math.pow(2,d)-1)*l+t:t-(i+(Math.pow(2,d)-1))*l}Math.trunc=Math.trunc||function(e){return isNaN(e)?NaN:e>0?Math.floor(e):Math.ceil(e)},e.exports={normalisation_batch:function(e){let t=e.date,a=p(e.batch1,e.batch2,e.payload,t);console.log(a);let l=[];for(let e=0;e<a.dataset.length;e++){let t=a.dataset[e],s={variable:t.data.label_name,value:t.data.value,date:t.data_absolute_timestamp};l.push(s)}return l}}},893:(e,t,a)=>{const l=a(186),s=a(769);e.exports={watteco_decodeUplink:function(e,t,a){e.bytes,e.fPort;let d=e.recvTime;try{let i=l.normalisation_standard(e,a),r=i.payload;if("batch"!==i.type)return{data:i.data,warnings:[i.warning]};{let e={batch1:t[0],batch2:t[1],payload:r,date:d};try{return{data:s.normalisation_batch(e),warnings:[""]}}catch(e){return{error:e.message,warnings:[""]}}}}catch(e){return{error:e.message,warnings:[""]}}}}},186:e=>{function t(e,t){return 2===t&&(32768&e)>0&&(e-=65536),3===t&&(8388608&e)>0&&(e-=16777216),4===t&&(2147483648&e)>0&&(e-=4294967296),e}function a(e){let t=2147483648&e?-1:1,a=(e>>23&255)-127,l=8388607&e;if(128===a)return t*(l?Number.NaN:Number.POSITIVE_INFINITY);if(-127===a){if(0===l)return 0;a=-126,l/=1<<23}else l=(l|1<<23)/(1<<23);return t*l*Math.pow(2,a)}function l(e,t,a,l){void 0===l&&(l=!1);let s,d,i="U"!=a.substr(0,1),r=parseInt(a.substr(1,2),10)/8,n=r;for(l?(s=-1,d=t+r-1):s=1,d=t,tmpInt64=0,j=d;n>0;j+=s,n--)tmpInt64=(tmpInt64<<8)+e[j];return i&&r<8&&128&e[d]&&(tmpInt64-=1<<8*r),tmpInt64}function s(e,t){let a=e.toString(16).toUpperCase();for(t=null==t?t=2:t;a.length<t;)a="0"+a;return"0x"+a}function d(e){var t,a="",l=e.toString(2);return a+=(t=8,String(l).padStart(t,"0"))}function i(e,t,a,l,s,i){let r=0;for(;0===a;){let n=l[i+3+e*r];if(void 0===n){console.log(t),s.zclheader.alarmmess=t,a=1;break}let o=d(n);if("1"===o[3]&&"0"===o[4]){let e="threshold",a="";a="1"===o[1]?"exceed":"fall";let l=a+" "+e+" detected";t.push(l)}if("0"===o[3]&&"1"===o[4]){let e="delta triggered";t.push(e)}r+=1}}function r(e,t,a,l,s,i,r){let n=0,o=0,u=e,m=0,_=0;for(;0===a;){let p=l[i+3+e*n];if(void 0===p){console.log(t),s.zclheader.alarmmess=t,a=1;break}e!==u&&(e=u);let b=d(p);if("1"===b[3]&&"0"===b[4]){"1"===d(l[i+6+e*n])[0]&&(o=1,e+=2);let a="threshold",s="";"1"===b[1]?(s="exceed",m=d(l[i+7+e*n])+d(l[i+8+e*n]),m=parseInt(m,2),1===o&&(_=d(l[i+9+e*n])+d(l[i+10+e*n]),_=parseInt(_,2))):(s="fall",1===o?(m=d(l[i+7+e*n])+d(l[i+8+e*n]),m=parseInt(m,2),_=d(l[i+9+e*n])+d(l[i+10+e*n]),_=parseInt(_,2)):(_=d(l[i+7+e*n])+d(l[i+8+e*n]),_=parseInt(_,2)));let u=a+" "+s+" detected: value: "+((256*l[i+4+e*n]+l[i+5+e*n])/r).toString()+" countUp: "+m+", countDown: "+_;t.push(u),1===o&&(e-=2,o=0)}if("0"===b[3]&&"1"===b[4]){let a="delta triggered : "+((256*l[i+4+(e-=3)*n]+l[i+5+e*n])/r).toString();t.push(a)}n+=1}}e.exports={normalisation_standard:function(e,n){let o="",u=e.bytes;console.log(e);let m=function(e,n){let o={lora:{}};o.lora.port=n;let u=e.length,m="";o.lora.payload="";for(let t=0;t<u;t++){m=e[t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.lora.payload+=m;let a=new Date;o.lora.date=a.toISOString()}if(125===n)if(!1==!(1&e[0])){o.zclheader={},o.zclheader.report="standard";let n=-1,u=-1,_=-1;if(o.zclheader.endpoint=(224&e[0])>>5|(6&e[0])<<2,u=e[1],o.zclheader.cmdID=s(u,2),_=256*e[2]+e[3],o.zclheader.clustID=s(_,4),10===u|138===u|1===u){o.data={},n=256*e[4]+e[5],o.zclheader.attID=s(n,4);let p=0;if(10!==u&&138!==u||(p=7),138===u&&(o.zclheader.alarm=1),1===u&&(p=8,o.zclheader.status=e[6]),1026===_&&0===n&&(o.data.temperature=t(256*e[p]+e[p+1],2)/100,138===u)){let t="",a=[],l=0,s=100;void 0===e[p+2]?(t="none",console.log("je suis dans le test undefined")):(t=d(e[p+2]),console.log("je suis dans le test defined")),"none"===t&&(a.push("alarm triggered"),o.zclheader.alarmmess=a),"0"===t[2]&&"1"===t[3]&&i(1,a,l,e,o,p),"1"===t[2]&&"0"===t[3]&&r(6,a,l,e,o,p,s)}if(1029===_&&0===n&&(o.data.humidity=(256*e[p]+e[p+1])/100,138===u)){void 0!==e[p+2]&&d(e[p+2]);let t=[],a=0,l=100,s="";void 0===e[p+2]?(s="none",console.log("je suis dans le test undefined")):(s=d(e[p+2]),console.log("je suis dans le test defined")),"none"===s&&(t.push("alarm triggered"),o.zclheader.alarmmess=t),"0"===s[2]&&"1"===s[3]&&i(1,t,a,e,o,p),"1"===s[2]&&"0"===s[3]&&r(6,t,a,e,o,p,l)}if(15===_&&1026===n&&(o.data.counter=256*e[p]*256*256+256*e[p+1]*256+256*e[p+2]+e[p+3]),15===_&&85===n&&(o.data.pin_state=!!e[p]),19===_&&85===n&&(o.data.value=e[p]),6===_&&0===n){let t=e[p];o.data.state=1===t?"ON":"OFF"}if(32776===_&&0===n&&(o.data.differential_pressure=256*e[p]+e[p+1]),32773===_&&0===n&&(o.data.pin_state_1=1==(1&e[p+1]),o.data.pin_state_2=2==(2&e[p+1]),o.data.pin_state_3=4==(4&e[p+1]),o.data.pin_state_4=8==(8&e[p+1]),o.data.pin_state_5=16==(16&e[p+1]),o.data.pin_state_6=32==(32&e[p+1]),o.data.pin_state_7=64==(64&e[p+1]),o.data.pin_state_8=128==(128&e[p+1]),o.data.pin_state_9=1==(1&e[p]),o.data.pin_state_10=2==(2&e[p])),12===_&&85===n&&(o.data.analog=a(256*e[p]*256*256+256*e[p+1]*256+256*e[p+2]+e[p+3]),138===u)){void 0!==e[p+2]&&d(e[p+2]);let t=[],a=0,l=1,s="";void 0===e[p+2]?(s="none",console.log("je suis dans le test undefined")):(s=d(e[p+2]),console.log("je suis dans le test defined")),"none"===s&&(t.push("alarm triggered"),o.zclheader.alarmmess=t),"0"===s[2]&&"1"===s[3]&&i(1,t,a,e,o,p),"1"===s[2]&&"0"===s[3]&&r(8,t,a,e,o,p,l)}if(32775===_&&1===n){o.data.payload="",o.data.modbus_payload="",o.data.size=e[p],o.data.modbus_float=0;for(let t=0;t<o.data.size;t++)if(m=e[p+t+1].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.payload+=m,0===t)o.data.modbus_address=e[p+t+1];else if(1===t)o.data.modbus_commandID=e[p+t+1];else if(2===t)o.data.modbus_size=e[p+t+1];else{if(o.data.modbus_payload+=m,1===o.data.modbus_float){let l=a(256*e[p+t+1]*256*256+256*e[p+t+1+1]*256+256*e[p+t+1+2]+e[p+t+1+3]);3===t&&(o.data.fregister_00=l),7===t&&(o.data.fregister_01=l),11===t&&(o.data.fregister_02=l),15===t&&(o.data.fregister_03=l),19===t&&(o.data.fregister_04=l),23===t&&(o.data.fregister_05=l),27===t&&(o.data.fregister_06=l),31===t&&(o.data.fregister_07=l),35===t&&(o.data.fregister_08=l),35===t&&(o.data.fregister_09=l)}if(2===o.data.modbus_float){let l=a(256*e[p+t+1]+e[p+t+1+1]+256*e[p+t+1+2]*256*256+256*e[p+t+1+3]*256);3===t&&(o.data.fregister_00=l),7===t&&(o.data.fregister_01=l),11===t&&(o.data.fregister_02=l),15===t&&(o.data.fregister_03=l),19===t&&(o.data.fregister_04=l),23===t&&(o.data.fregister_05=l),27===t&&(o.data.fregister_06=l),31===t&&(o.data.fregister_07=l),35===t&&(o.data.fregister_08=l),35===t&&(o.data.fregister_09=l)}}}if(32777===_&&0===n){let t=e[p+2],a=e[p+3];o.data.payloads="",o.data.size=e[p],o.data.multimodbus_frame_series_sent=e[p+1],o.data.multimodbus_frame_number_in_serie=(224&t)>>5,o.data.multimodbus_last_frame_of_serie=(28&t)>>2,o.data.multimodbus_EP9=1==(1&t),o.data.multimodbus_EP8=2==(2&t),o.data.multimodbus_EP7=128==(128&a),o.data.multimodbus_EP6=64==(64&a),o.data.multimodbus_EP5=32==(32&a),o.data.multimodbus_EP4=16==(16&a),o.data.multimodbus_EP3=8==(8&a),o.data.multimodbus_EP2=4==(4&a),o.data.multimodbus_EP1=2==(2&a),o.data.multimodbus_EP0=1==(1&a);let l=p+4;if(without_header=0,!0===o.data.multimodbus_EP0){if(0===without_header&&(o.data.multimodbus_EP0_slaveID=e[l],o.data.multimodbus_EP0_fnctID=e[l+1],o.data.multimodbus_EP0_datasize=e[l+2],l+=3),o.data.multimodbus_EP0_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP0_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP0_payload+=m;l+=o.data.multimodbus_EP0_datasize}if(!0===o.data.multimodbus_EP1){if(0===without_header&&(o.data.multimodbus_EP1_slaveID=e[l],o.data.multimodbus_EP1_fnctID=e[l+1],o.data.multimodbus_EP1_datasize=e[l+2],l+=3),o.data.multimodbus_EP1_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP1_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP1_payload+=m;l+=o.data.multimodbus_EP1_datasize}if(!0===o.data.multimodbus_EP2){if(0===without_header&&(o.data.multimodbus_EP2_slaveID=e[l],o.data.multimodbus_EP2_fnctID=e[l+1],o.data.multimodbus_EP2_datasize=e[l+2],l+=3),o.data.multimodbus_EP2_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP2_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP2_payload+=m;l+=o.data.multimodbus_EP2_datasize}if(!0===o.data.multimodbus_EP3){if(0===without_header&&(o.data.multimodbus_EP3_slaveID=e[l],o.data.multimodbus_EP3_fnctID=e[l+1],o.data.multimodbus_EP3_datasize=e[l+2],l+=3),o.data.multimodbus_EP3_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP3_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP3_payload+=m;l+=o.data.multimodbus_EP3_datasize}if(!0===o.data.multimodbus_EP4){if(0===without_header&&(o.data.multimodbus_EP4_slaveID=e[l],o.data.multimodbus_EP4_fnctID=e[l+1],o.data.multimodbus_EP4_datasize=e[l+2],l+=3),o.data.multimodbus_EP4_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP4_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP4_payload+=m;l+=o.data.multimodbus_EP4_datasize}if(!0===o.data.multimodbus_EP5){if(0===without_header&&(o.data.multimodbus_EP5_slaveID=e[l],o.data.multimodbus_EP5_fnctID=e[l+1],o.data.multimodbus_EP5_datasize=e[l+2],l+=3),o.data.multimodbus_EP5_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP5_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP5_payload+=m;l+=o.data.multimodbus_EP5_datasize}if(!0===o.data.multimodbus_EP6){if(0===without_header&&(o.data.multimodbus_EP6_slaveID=e[l],o.data.multimodbus_EP6_fnctID=e[l+1],o.data.multimodbus_EP6_datasize=e[l+2],l+=3),o.data.multimodbus_EP6_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP6_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP6_payload+=m;l+=o.data.multimodbus_EP6_datasize}if(!0===o.data.multimodbus_EP7){if(0===without_header&&(o.data.multimodbus_EP7_slaveID=e[l],o.data.multimodbus_EP7_fnctID=e[l+1],o.data.multimodbus_EP7_datasize=e[l+2],l+=3),o.data.multimodbus_EP7_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP7_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP7_payload+=m;l+=o.data.multimodbus_EP7_datasize}if(!0===o.data.multimodbus_EP8){if(0===without_header&&(o.data.multimodbus_EP8_slaveID=e[l],o.data.multimodbus_EP8_fnctID=e[l+1],o.data.multimodbus_EP8_datasize=e[l+2],l+=3),o.data.multimodbus_EP8_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP8_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP8_payload+=m;l+=o.data.multimodbus_EP8_datasize}if(!0===o.data.multimodbus_EP9){if(0===without_header&&(o.data.multimodbus_EP6_slaveID=e[l],o.data.multimodbus_EP6_fnctID=e[l+1],o.data.multimodbus_EP6_datasize=e[l+2],l+=3),o.data.multimodbus_EP6_payload="",void 0===e[l])return o;for(let t=0;t<o.data.multimodbus_EP6_datasize;t++)m=e[l+t].toString(16).toUpperCase(),1===m.length&&(m="0"+m),o.data.multimodbus_EP6_payload+=m;l+=o.data.multimodbus_EP6_datasize}}if(82===_&&0===n&&(o.data.active_energy_Wh=t(256*e[p+1]*256+256*e[p+2]+e[p+3],3),o.data.reactive_energy_Varh=t(256*e[p+4]*256+256*e[p+5]+e[p+6],3),o.data.nb_samples=256*e[p+7]+e[p+8],o.data.active_power_W=t(256*e[p+9]+e[p+10],2),o.data.reactive_power_let=t(256*e[p+11]+e[p+12],2)),32772===_&&0===n&&(1===e[p]&&(o.data.message_type="confirmed"),0===e[p]&&(o.data.message_type="unconfirmed")),32772===_&&1===n&&(o.data.nb_retry=e[p]),32772===_&&2===n&&(o.data.period_in_minutes=256*e[p+1]+e[p+2],o.data.nb_err_frames=256*e[p+3]+e[p+4]),80===_&&6===n){let t=p+3;if(1==(1&e[p+2])&&(o.data.main_or_external_voltage=(256*e[t]+e[t+1])/1e3,t+=2),2==(2&e[p+2])&&(o.data.rechargeable_battery_voltage=(256*e[t]+e[t+1])/1e3,t+=2),4==(4&e[p+2])&&(o.data.disposable_battery_voltage=(256*e[t]+e[t+1])/1e3,t+=2),8==(8&e[p+2])&&(o.data.solar_harvesting_voltage=(256*e[t]+e[t+1])/1e3,t+=2),16==(16&e[p+2])&&(o.data.tic_harvesting_voltage=(256*e[t]+e[t+1])/1e3,t+=2),138===u){void 0!==e[p+2]&&d(e[p+2]);let t=[],a=0,l=1e3,s="";void 0===e[p+2]?(s="none",console.log("je suis dans le test undefined")):(s=d(e[p+2]),console.log("je suis dans le test defined")),"none"===s&&(t.push("alarm triggered"),o.zclheader.alarmmess=t),"0"===s[2]&&"1"===s[3]&&i(1,t,a,e,o,p),"1"===s[2]&&"0"===s[3]&&r(6,t,a,e,o,p,l)}}if(32778===_&&0===n){let a=p;o.data.sum_positive_active_energy_Wh=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.sum_negative_active_energy_Wh=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.sum_positive_reactive_energy_Wh=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.sum_negative_reactive_energy_Wh=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.positive_active_power_W=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.negative_active_power_W=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.positive_reactive_power_W=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4),a+=4,o.data.negative_reactive_power_W=t(256*e[a+1]*256*256+256*e[a+2]*256+256*e[a+3]+e[a+4],4)}if(32784===_&&0===n?(o.data.ActiveEnergyWhPhaseA=Int32UnsignedToSigned(256*e[p+1]*256*256+256*e[p+2]*256+256*e[p+3]+e[p+4]),o.data.ReactiveEnergyWhPhaseA=Int32UnsignedToSigned(256*e[p+5]*256*256+256*e[p+6]*256+256*e[p+7]+e[p+8]),o.data.ActiveEnergyWhPhaseB=Int32UnsignedToSigned(256*e[p+9]*256*256+256*e[p+10]*256+256*e[p+11]+e[p+12]),o.data.ReactiveEnergyWhPhaseB=Int32UnsignedToSigned(256*e[p+13]*256*256+256*e[p+14]*256+256*e[p+15]+e[p+16]),o.data.ActiveEnergyWhPhaseC=Int32UnsignedToSigned(256*e[p+17]*256*256+256*e[p+18]*256+256*e[p+19]+e[p+20]),o.data.ReactiveEnergyWhPhaseC=Int32UnsignedToSigned(256*e[p+21]*256*256+256*e[p+22]*256+256*e[p+23]+e[p+24]),o.data.ActiveEnergyWhPhaseABC=Int32UnsignedToSigned(256*e[p+25]*256*256+256*e[p+26]*256+256*e[p+27]+e[p+28]),o.data.ReactiveEnergyWhPhaseABC=Int32UnsignedToSigned(256*e[p+29]*256*256+256*e[p+30]*256+256*e[p+31]+e[p+32])):32784===_&&1===n&&(o.data.ActivePowerWPhaseA=Int32UnsignedToSigned(256*e[p+1]*256*256+256*e[p+2]*256+256*e[p+3]+e[p+4]),o.data.ReactivePowerWPhaseA=Int32UnsignedToSigned(256*e[p+5]*256*256+256*e[p+6]*256+256*e[p+7]+e[p+8]),o.data.ActivePowerWPhaseB=Int32UnsignedToSigned(256*e[p+9]*256*256+256*e[p+10]*256+256*e[p+11]+e[p+12]),o.data.ReactivePowerWPhaseB=Int32UnsignedToSigned(256*e[p+13]*256*256+256*e[p+14]*256+256*e[p+15]+e[p+16]),o.data.ActivePowerWPhaseC=Int32UnsignedToSigned(256*e[p+17]*256*256+256*e[p+18]*256+256*e[p+19]+e[p+20]),o.data.ReactivePowerWPhaseC=Int32UnsignedToSigned(256*e[p+21]*256*256+256*e[p+22]*256+256*e[p+23]+e[p+24]),o.data.ActivePowerWPhaseABC=Int32UnsignedToSigned(256*e[p+25]*256*256+256*e[p+26]*256+256*e[p+27]+e[p+28]),o.data.ReactivePowerWPhaseABC=Int32UnsignedToSigned(256*e[p+29]*256*256+256*e[p+30]*256+256*e[p+31]+e[p+32])),32779===_&&0===n){let a=p;o.data.Vrms=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Irms=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.phase_angle=t(256*e[a+1]+e[a+2],2)}if(32781===_&&0===n&&(o.data.VrmsA=t(256*e[p+1]+e[p+2],2)/10,o.data.IrmsA=t(256*e[p+3]+e[p+4],2)/10,o.data.PhaseA=t(256*e[p+5]+e[p+6],2),o.data.VrmsB=t(256*e[p+7]+e[p+8],2)/10,o.data.IrmsB=t(256*e[p+9]+e[p+10],2)/10,o.data.PhaseB=t(256*e[p+11]+e[p+12],2),o.data.VrmsC=t(256*e[p+13]+e[p+14],2)/10,o.data.IrmsC=t(256*e[p+15]+e[p+16],2)/10,o.data.PhaseC=t(256*e[p+17]+e[p+18],2)),32780===_&&0===n&&(o.data.Concentration=256*e[p]+e[p+1],138===u)){void 0!==e[p+2]&&d(e[p+2]);let t=[],a=0,l=1,s="";void 0===e[p+2]?(s="none",console.log("je suis dans le test undefined")):(s=d(e[p+2]),console.log("je suis dans le test defined")),"none"===s&&(t.push("alarm triggered"),o.zclheader.alarmmess=t),"0"===s[2]&&"1"===s[3]&&i(1,t,a,e,o,p),"1"===s[2]&&"0"===s[3]&&r(6,t,a,e,o,p,l)}if(1024===_&&0===n&&(o.data.Illuminance=256*e[p]+e[p+1]),1027===_&&0===n&&(o.data.Pressure=t(256*e[p]+e[p+1],2)),1030===_&&0===n&&(o.data.Occupancy=!!e[p]),32850===_&&0===n){let a=p;o.data.frequency=(t(256*e[a+1]+e[a+2],2)+22232)/1e3,a+=2,o.data.frequency_min=(t(256*e[a+1]+e[a+2],2)+22232)/1e3,a+=2,o.data.frequency_max=(t(256*e[a+1]+e[a+2],2)+22232)/1e3,a+=2,o.data.Vrms=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Vrms_min=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Vrms_max=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Vpeak=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Vpeak_min=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.Vpeak_max=t(256*e[a+1]+e[a+2],2)/10,a+=2,o.data.over_voltage=t(256*e[a+1]+e[a+2],2),a+=2,o.data.sag_voltage=t(256*e[a+1]+e[a+2],2)}if(32783===_){let t=p+1;if(0===n){let a=o.data.Last={};a.NbTriggedAcq=l(e,t,"U32"),t+=4,a.Mean_X_G=l(e,t,"U16")/100,t+=2,a.Max_X_G=l(e,t,"U16")/100,t+=2,a.Dt_X_ms=l(e,t,"U16"),t+=2,a.Mean_Y_G=l(e,t,"U16")/100,t+=2,a.Max_Y_G=l(e,t,"U16")/100,t+=2,a.Dt_Y_ms=l(e,t,"U16"),t+=2,a.Mean_Z_G=l(e,t,"U16")/100,t+=2,a.Max_Z_G=l(e,t,"U16")/100,t+=2,a.Dt_Z_ms=l(e,t,"U16")}else if(1===n||2===n||3===n){let a=1===n?"Stats_X":2===n?"Stats_Y":"Stats_Z",s=o.data[a]={};s.NbAcq=l(e,t,"U16"),t+=2,s.MinMean_G=l(e,t,"U16")/100,t+=2,s.MinMax_G=l(e,t,"U16")/100,t+=2,s.MinDt=l(e,t,"U16"),t+=2,s.MeanMean_G=l(e,t,"U16")/100,t+=2,s.MeanMax_G=l(e,t,"U16")/100,t+=2,s.MeanDt=l(e,t,"U16"),t+=2,s.MaxMean_G=l(e,t,"U16")/100,t+=2,s.MaxMax_G=l(e,t,"U16")/100,t+=2,s.MaxDt=l(e,t,"U16"),t+=2}else if(32768===n){let a=o.data.Params={};a.WaitFreq_Hz=l(e,t,"U16")/10,t+=2,a.AcqFreq_Hz=l(e,t,"U16")/10,t+=2;let s=l(e,t,"U16");t+=2,32768&s&&(s=60*(-32769&s)),a.NewWaitDelay_s=32768&s?s=60*(-32769&s):s,a.MaxAcqDuration_ms=l(e,t,"U16"),t+=2,a.Threshold_X_G=l(e,t,"U16")/100,t+=2,a.Threshold_Y_G=l(e,t,"U16")/100,t+=2,a.Threshold_Z_G=l(e,t,"U16")/100,t+=2,a.OverThrsh_Dt_ms=l(e,t,"U16"),t+=2,a.UnderThrsh_Dt_ms=l(e,t,"U16"),t+=2,a.Range_G=l(e,t,"U16")/100,t+=2,a.FilterSmoothCoef=l(e,t,"U8"),t+=1,a.FilterGainCoef=l(e,t,"U8"),t+=1,a=o.data.Params.WorkingModes={},a.SignalEachAcq=128&e[t]?"true":"false",a.RstAftStdRpt_X=1&e[t]?"true":"false",a.RstAftStdRpt_Y=2&e[t]?"true":"false",a.RstAftStdRpt_7=4&e[t]?"true":"false"}}}7===u&&(n=256*e[6]+e[7],o.zclheader.attID=s(n,4),o.zclheader.status=e[4],o.zclheader.batch=e[5]),9===u&&(n=256*e[6]+e[7],o.zclheader.attID=s(n,4),o.zclheader.status=e[4],o.zclheader.batch=e[5],o.zclheader.attribut_type=e[8],o.zclheader.min={},128==(128&e[9])?(o.zclheader.min.value=256*(e[9]-128)+e[10],o.zclheader.min.unity="minutes"):(o.zclheader.min.value=256*e[9]+e[10],o.zclheader.min.unity="seconds"),o.zclheader.max={},128==(128&e[11])?(o.zclheader.max.value=256*(e[11]-128)+e[12],o.zclheader.max.unity="minutes"):(o.zclheader.max.value=256*e[11]+e[12],o.zclheader.max.unity="seconds"),o.lora.payload="")}else o.batch={},o.batch.report="batch";return o}(u,e.fPort);if(console.log(m),void 0!==m.zclheader&&m.zclheader.alarm&&(o=m.zclheader.alarmmess,console.log(o)),7===u[1]&&u[0]%2!=0)return{data:{variable:"configure reporting response status",value:m.zclheader.status,date:e.recvTime},warning:o};if(9===u[1])return{data:{variable:"read reporting configuration response status",value:m.zclheader.status,date:e.recvTime},warning:o};if(1===u[1])return void 0===m.zclheader.data?{data:{variable:"read reporting configuration response status",value:"no data",date:e.recvTime},warning:o}:{data:{variable:"read reporting configuration response status",value:m.zclheader.data,date:e.recvTime},warning:o};if(void 0!==m.zclheader){if(void 0!==n){let t=m.zclheader.endpoint,a=Object.keys(m.data)[0];return{data:{variable:n[a][t],value:m.data[a],date:e.recvTime},type:"standard",warning:o}}{let t=Object.keys(m.data)[0];return{data:{variable:t,value:m.data[t],date:e.recvTime},type:"standard",warning:o}}}return{type:m.batch.report,payload:m.lora.payload}}}}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var d=t[l]={exports:{}};return e[l](d,d.exports,a),d.exports}return a(186),a(769),a(893),a(575)})()));