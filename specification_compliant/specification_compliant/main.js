(()=>{var e={10:(e,t)=>{function a(e,t){return 2===t&&(32768&e)>0&&(e-=65536),3===t&&(8388608&e)>0&&(e-=16777216),4===t&&(2147483648&e)>0&&(e-=4294967296),e}function d(e){var t=2147483648&e?-1:1,a=(e>>23&255)-127,i=8388607&e;if(128==a)return t*(i?Number.NaN:Number.POSITIVE_INFINITY);if(-127==a){if(0==i)return 0*t;a=-126,i/=1<<23}else i=(i|1<<23)/(1<<23);return t*i*Math.pow(2,a)}function n(e,t,a,i){void 0===i&&(i=!1);var d,n,r="U"!=a.substr(0,1),s=parseInt(a.substr(1,2),10)/8,l=s;for(i?(d=-1,n=t+s-1):(d=1,n=t),tmpInt64=0,j=n;l>0;j+=d,l--)tmpInt64=(tmpInt64<<8)+e[j];return r&&s<8&&128&e[n]&&(tmpInt64-=1<<8*s),tmpInt64}function r(e,t){var a=e.toString(16).toUpperCase();for(t=null==t?t=2:t;a.length<t;)a="0"+a;return"0x"+a}function s(e){for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}var l=3,u=4,x=5,m=6,_=7,b=9,c=10,p=12,g={0:0,1:1,2:4};g[l]=4,g[u]=8,g[x]=8,g[m]=16,g[_]=16,g[8]=24,g[b]=24,g[c]=32,g[11]=32,g[p]=32;var h=14,f=16,v=[[{sz:2,lbl:0},{sz:2,lbl:1},{sz:2,lbl:3},{sz:3,lbl:5},{sz:4,lbl:9},{sz:5,lbl:17},{sz:6,lbl:33},{sz:7,lbl:65},{sz:8,lbl:129},{sz:10,lbl:512},{sz:11,lbl:1026},{sz:11,lbl:1027},{sz:11,lbl:1028},{sz:11,lbl:1029},{sz:11,lbl:1030},{sz:11,lbl:1031}],[{sz:7,lbl:111},{sz:5,lbl:26},{sz:4,lbl:12},{sz:3,lbl:3},{sz:3,lbl:7},{sz:2,lbl:2},{sz:2,lbl:0},{sz:3,lbl:2},{sz:6,lbl:54},{sz:9,lbl:443},{sz:9,lbl:441},{sz:10,lbl:885},{sz:10,lbl:884},{sz:10,lbl:880},{sz:11,lbl:1763},{sz:11,lbl:1762}],[{sz:4,lbl:9},{sz:3,lbl:5},{sz:2,lbl:0},{sz:2,lbl:1},{sz:2,lbl:3},{sz:5,lbl:17},{sz:6,lbl:33},{sz:7,lbl:65},{sz:8,lbl:129},{sz:10,lbl:512},{sz:11,lbl:1026},{sz:11,lbl:1027},{sz:11,lbl:1028},{sz:11,lbl:1029},{sz:11,lbl:1030},{sz:11,lbl:1031}]];function I(e,t,a,i){var d=function(){for(var e=[],t=0;t<f;)e.push({codingType:0,codingTable:0,resolution:null,uncompressSamples:[]}),t+=1;return{batch_counter:0,batch_relative_timestamp:0,series:e}}(),n=function(e){function t(e,t,a){var i=t,d=a-1;if(8*e.length<i+a)throw new Error("Batch : Verify that dest buf is large enough");for(var n=0,r=0;a>0;)e[i>>3]&1<<(7&i)&&(r|=1<<d-n),a--,n++,i++;return r}return{index:0,byteArray:e,getNextSample:function(e,t){var a=t||g[e],i=this.index;if(this.index+=a,e===p&&32!==a)throw new Error("Batch : Mauvais sampletype");var d=0,n=Math.trunc((a-1)/8)+1,r=a%8;for(0===r&&n>0&&(r=8);n>0;){for(var s=0;r>0;){var u=i>>3;this.byteArray[u]&1<<(7&i)&&(d|=1<<8*(n-1)+s),r--,s++,i+=1}n--,r=8}if((e==l||e==x||e==_||e==b)&&d&1<<a-1)for(var o=a;o<32;o++)d|=1<<o,a++;return d},getNextBifromHi:function(e){for(var a=2;a<12;a++)for(var i=t(this.byteArray,this.index,a),d=0;d<v[e].length;d++)if(v[e][d].sz==a&&i==v[e][d].lbl)return this.index+=a,d;throw new Error("Bi not found in HUFF table")}}}(s(a)),r=function(e){for(var t=e.toString(2);t.length<8;)t="0"+t;return{isCommonTimestamp:parseInt(t[t.length-2],2),hasSample:!parseInt(t[t.length-3],2),batch_req:parseInt(t[t.length-4],2),nb_of_type_measure:parseInt(t.substring(0,4),2)}}(n.getNextSample(u));d.batch_counter=n.getNextSample(u,3),n.getNextSample(u,1);var o=function(e,t,a,i,d){for(var n=0,r=0,s=0;s<i.nb_of_type_measure;s++){var l={size:d,lbl:t.getNextSample(u,d)},o=D(a,l);0===s&&(r=o),n=z(t,n),e.series[o]=P(t,a[o].sampletype,l.lbl,n),i.hasSample&&(e.series[o].codingType=t.getNextSample(u,2),e.series[o].codingTable=t.getNextSample(u,2))}return{last_timestamp:n,index_of_the_first_sample:r}}(d,n,t,r,e),m=o.last_timestamp,I=o.index_of_the_first_sample;return r.hasSample&&(m=function(e,t,a,i,d,n,r){return n.isCommonTimestamp?function(e,t,a,i,d,n){for(var r=t.getNextSample(u,8),s={},l=function(e,t,a,i){for(var d=[],n=0,r=t.getNextSample(u,2),s=0;s<a;s++){var l=t.getNextBifromHi(r);if(l<=h)if(0===s)d.push(e.series[i].uncompressSamples[0].data_relative_timestamp);else if(l>0){var o=d[s-1];d.push(t.getNextSample(c,l)+o+Math.pow(2,l)-1)}else d.push(o);else d.push(t.getNextSample(c));n=d[s]}return{timestampCommon:d,lastTimestamp:n}}(e,t,r,a),o=l.timestampCommon,x=l.lastTimestamp,m=0;m<d.nb_of_type_measure;m++){var _=1;s.lbl=t.getNextSample(u,n);for(var b=D(i,s),p=0;p<r;p++)if(t.getNextSample(u,1)){var g=t.getNextBifromHi(e.series[b].codingTable),f={data_relative_timestamp:0,data:{}};if(g<=h){var v=e.series[b].uncompressSamples[e.series[b].uncompressSamples.length-1].data.value;if(g>0)f.data.value=S(t,v,e.series[b].codingType,i[b].resol,g);else{if(_){_=0;continue}f.data.value=v}}else f.data.value=t.getNextSample(i[b].sampletype);f.data_relative_timestamp=o[p],e.series[b].uncompressSamples.push(f)}}return x}(e,t,a,i,n,r):function(e,t,a,i,d,n){for(var r={},s=0;s<d.nb_of_type_measure;s++){r.lbl=t.getNextSample(u,n);var l=D(a,r),o=t.getNextSample(u,8);if(o)for(var x=t.getNextSample(u,2),m=0;m<o;m++){var _=e.series[l].uncompressSamples[e.series[l].uncompressSamples.length-1].data_relative_timestamp,b={data_relative_timestamp:0,data:{}},c=t.getNextBifromHi(x);if(b.data_relative_timestamp=y(t,_,c),b.data_relative_timestamp>i&&(i=b.data_relative_timestamp),(c=t.getNextBifromHi(e.series[l].codingTable))<=h){var p=e.series[l].uncompressSamples[e.series[l].uncompressSamples.length-1].data.value;b.data.value=c>0?S(t,p,e.series[l].codingType,a[l].resol,c):p}else b.data.value=t.getNextSample(a[l].sampletype);e.series[l].uncompressSamples.push(b)}}return i}(e,t,i,d,n,r)}(d,n,I,t,m,r,e)),d.batch_relative_timestamp=z(n,m),function(e,t,a){var i={batch_counter:e.batch_counter,batch_relative_timestamp:e.batch_relative_timestamp};return a&&(i.batch_absolute_timestamp=a),i.dataset=e.series.reduce((function(i,d,n){return i.concat(d.uncompressSamples.map((function(i){var d,r,s,l={data_relative_timestamp:i.data_relative_timestamp,data:{value:t[n].divide?i.data.value/t[n].divide:i.data.value,label:t[n].taglbl}};return t[n].lblname&&(l.data.label_name=t[n].lblname),a&&(l.data_absolute_timestamp=(d=a,r=e.batch_relative_timestamp,s=i.data_relative_timestamp,new Date(new Date(d)-1e3*(r-s)).toISOString())),l})))}),[]),i}(d,t,i)}function s(e){if(null!=e){e=e.toString().split("").filter((function(e){return!isNaN(parseInt(e,16))})).join("");for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}-1===myerror.indexOf("Batch : Invalid hex string")&&myerror.push("Batch : Invalid hex string")}function P(e,t,a,i){return{uncompressSamples:[{data_relative_timestamp:i,data:{value:E(e,t),label:a}}],codingType:0,codingTable:0,resolution:null}}function D(e,t){for(var a=0;a<e.length;a++)if(e[a].taglbl===t.lbl)return a;throw new Error("Batch : Cannot find index in argList")}function z(e,t){if(t){var a=e.getNextBifromHi(1);return y(e,t,a)}return e.getNextSample(c)}function y(e,t,a){return a>h?e.getNextSample(c):a>0?function(e,t,a){return e.getNextSample(c,a)+t+Math.pow(2,a)-1}(e,t,a):t}function E(e,t){var a=e.getNextSample(t);return t===p?function(e){var t=2147483648&e?-1:1,a=(e>>23&255)-127,i=8388607&e;if(128==a)return t*(i?Number.NaN:Number.POSITIVE_INFINITY);if(-127==a){if(0===i)return 0*t;a=-126,i/=1<<22}else i=(i|1<<23)/(1<<23);return t*i*Math.pow(2,a)}(a):a}function S(e,t,a,i,d){var n=e.getNextSample(m,d);return 0===a?function(e,t,a,i){return e>=Math.pow(2,i-1)?e*t+a:(e+1-Math.pow(2,i))*t+a}(n,i,t,d):1===a?(n+Math.pow(2,d)-1)*i+t:t-(n+(Math.pow(2,d)-1))*i}Math.trunc=Math.trunc||function(e){return isNaN(e)?NaN:e>0?Math.floor(e):Math.ceil(e)};try{e.exports=I}catch(e){t.err_msg=e}function U(e,t,s){e.bytes,e.fPort;let l=e.recvTime;try{let u=function(e,t){let s=e.bytes,l="",u=function(e,t){var s={lora:{}};s.lora.port=t;var l=e.length,u="";s.lora.payload="";for(var x=0;x<l;x++){1===(u=e[x].toString(16).toUpperCase()).length&&(u="0"+u),s.lora.payload+=u;var m=new Date;s.lora.date=m.toISOString()}if(125===t)if(batch=!(1&e[0]),!1===batch){if(s.zclheader={},s.zclheader.report="standard",attributID=-1,cmdID=-1,clusterdID=-1,s.zclheader.endpoint=(224&e[0])>>5|(6&e[0])<<2,cmdID=e[1],s.zclheader.cmdID=r(cmdID,2),clusterdID=256*e[2]+e[3],s.zclheader.clusterdID=r(clusterdID,4),10===cmdID|138===cmdID|1===cmdID){if(s.data={},attributID=256*e[4]+e[5],s.zclheader.attributID=r(attributID,4),138===cmdID&&(s.zclheader.alarm=1),10===cmdID|138===cmdID&&(index=7),1===cmdID&&(index=8,s.zclheader.status=e[6]),1026===clusterdID&0===attributID&&(s.data.temperature=a(256*e[index]+e[index+1],2)/100),1029===clusterdID&0===attributID&&(s.data.humidity=(256*e[index]+e[index+1])/100),15===clusterdID&1026===attributID&&(s.data.counter=256*e[index]*256*256+256*e[index+1]*256+256*e[index+2]+e[index+3]),15===clusterdID&85===attributID&&(s.data.pin_state=!!e[index]),19===clusterdID&85===attributID&&(s.data.value=e[index]),6===clusterdID&0===attributID&&(state=e[index],1===state?s.data.state="ON":s.data.state="OFF"),32776===clusterdID&0===attributID&&(s.data.differential_pressure=256*e[index]+e[index+1]),32773===clusterdID&0===attributID&&(s.data.pin_state_1=1==(1&e[index+1]),s.data.pin_state_2=2==(2&e[index+1]),s.data.pin_state_3=4==(4&e[index+1]),s.data.pin_state_4=8==(8&e[index+1]),s.data.pin_state_5=16==(16&e[index+1]),s.data.pin_state_6=32==(32&e[index+1]),s.data.pin_state_7=64==(64&e[index+1]),s.data.pin_state_8=128==(128&e[index+1]),s.data.pin_state_9=1==(1&e[index]),s.data.pin_state_10=2==(2&e[index])),12===clusterdID&85===attributID&&(s.data.analog=d(256*e[index]*256*256+256*e[index+1]*256+256*e[index+2]+e[index+3])),32775===clusterdID&1===attributID)for(s.data.payload="",s.data.modbus_payload="",s.data.size=e[index],s.data.modbus_float=0,x=0;x<s.data.size;x++)1==(u=e[index+x+1].toString(16).toUpperCase()).length&&(u="0"+u),s.data.payload+=u,0==x?s.data.modbus_address=e[index+x+1]:1==x?s.data.modbus_commandID=e[index+x+1]:2==x?s.data.modbus_size=e[index+x+1]:(s.data.modbus_payload+=u,1==s.data.modbus_float&&(3==x&&(s.data.fregister_00=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),7==x&&(s.data.fregister_01=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),11==x&&(s.data.fregister_02=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),15==x&&(s.data.fregister_03=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),19==x&&(s.data.fregister_04=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),23==x&&(s.data.fregister_05=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),27==x&&(s.data.fregister_06=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),31==x&&(s.data.fregister_07=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),35==x&&(s.data.fregister_08=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3])),35==x&&(s.data.fregister_09=d(256*e[index+x+1]*256*256+256*e[index+x+1+1]*256+256*e[index+x+1+2]+e[index+x+1+3]))),2==s.data.modbus_float&&(3==x&&(s.data.fregister_00=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),7==x&&(s.data.fregister_01=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),11==x&&(s.data.fregister_02=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),15==x&&(s.data.fregister_03=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),19==x&&(s.data.fregister_04=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),23==x&&(s.data.fregister_05=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),27==x&&(s.data.fregister_06=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),31==x&&(s.data.fregister_07=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),35==x&&(s.data.fregister_08=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256)),35==x&&(s.data.fregister_09=d(256*e[index+x+1]+e[index+x+1+1]+256*e[index+x+1+2]*256*256+256*e[index+x+1+3]*256))));if(32777===clusterdID&0===attributID){if(s.data.payloads="",s.data.size=e[index],s.data.multimodbus_frame_series_sent=e[index+1],s.data.multimodbus_frame_number_in_serie=(224&e[index+2])>>5,s.data.multimodbus_last_frame_of_serie=(28&e[index+2])>>2,s.data.multimodbus_EP9=1==(1&e[index+2]),s.data.multimodbus_EP8=2==(2&e[index+2]),s.data.multimodbus_EP7=128==(128&e[index+3]),s.data.multimodbus_EP6=64==(64&e[index+3]),s.data.multimodbus_EP5=32==(32&e[index+3]),s.data.multimodbus_EP4=16==(16&e[index+3]),s.data.multimodbus_EP3=8==(8&e[index+3]),s.data.multimodbus_EP2=4==(4&e[index+3]),s.data.multimodbus_EP1=2==(2&e[index+3]),s.data.multimodbus_EP0=1==(1&e[index+3]),index2=index+4,without_header=0,!0===s.data.multimodbus_EP0){if(0===without_header&&(s.data.multimodbus_EP0_slaveID=e[index2],index2+=1,s.data.multimodbus_EP0_fnctID=e[index2],index2+=1,s.data.multimodbus_EP0_datasize=e[index2],index2+=1),s.data.multimodbus_EP0_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP0_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP0_payload+=u;index2+=s.data.multimodbus_EP0_datasize}if(!0===s.data.multimodbus_EP1){if(0===without_header&&(s.data.multimodbus_EP1_slaveID=e[index2],index2+=1,s.data.multimodbus_EP1_fnctID=e[index2],index2+=1,s.data.multimodbus_EP1_datasize=e[index2],index2+=1),s.data.multimodbus_EP1_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP1_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP1_payload+=u;index2+=s.data.multimodbus_EP1_datasize}if(!0===s.data.multimodbus_EP2){if(0===without_header&&(s.data.multimodbus_EP2_slaveID=e[index2],index2+=1,s.data.multimodbus_EP2_fnctID=e[index2],index2+=1,s.data.multimodbus_EP2_datasize=e[index2],index2+=1),s.data.multimodbus_EP2_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP2_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP2_payload+=u;index2+=s.data.multimodbus_EP2_datasize}if(!0===s.data.multimodbus_EP3){if(0===without_header&&(s.data.multimodbus_EP3_slaveID=e[index2],index2+=1,s.data.multimodbus_EP3_fnctID=e[index2],index2+=1,s.data.multimodbus_EP3_datasize=e[index2],index2+=1),s.data.multimodbus_EP3_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP3_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP3_payload+=u;index2+=s.data.multimodbus_EP3_datasize}if(!0===s.data.multimodbus_EP4){if(0===without_header&&(s.data.multimodbus_EP4_slaveID=e[index2],index2+=1,s.data.multimodbus_EP4_fnctID=e[index2],index2+=1,s.data.multimodbus_EP4_datasize=e[index2],index2+=1),s.data.multimodbus_EP4_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP4_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP4_payload+=u;index2+=s.data.multimodbus_EP4_datasize}if(!0===s.data.multimodbus_EP5){if(0===without_header&&(s.data.multimodbus_EP5_slaveID=e[index2],index2+=1,s.data.multimodbus_EP5_fnctID=e[index2],index2+=1,s.data.multimodbus_EP5_datasize=e[index2],index2+=1),s.data.multimodbus_EP5_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP5_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP5_payload+=u;index2+=s.data.multimodbus_EP5_datasize}if(!0===s.data.multimodbus_EP6){if(0===without_header&&(s.data.multimodbus_EP6_slaveID=e[index2],index2+=1,s.data.multimodbus_EP6_fnctID=e[index2],index2+=1,s.data.multimodbus_EP6_datasize=e[index2],index2+=1),s.data.multimodbus_EP6_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP6_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP6_payload+=u;index2+=s.data.multimodbus_EP6_datasize}if(!0===s.data.multimodbus_EP7){if(0===without_header&&(s.data.multimodbus_EP7_slaveID=e[index2],index2+=1,s.data.multimodbus_EP7_fnctID=e[index2],index2+=1,s.data.multimodbus_EP7_datasize=e[index2],index2+=1),s.data.multimodbus_EP7_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP7_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP7_payload+=u;index2+=s.data.multimodbus_EP7_datasize}if(!0===s.data.multimodbus_EP8){if(0===without_header&&(s.data.multimodbus_EP8_slaveID=e[index2],index2+=1,s.data.multimodbus_EP8_fnctID=e[index2],index2+=1,s.data.multimodbus_EP8_datasize=e[index2],index2+=1),s.data.multimodbus_EP8_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP8_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP8_payload+=u;index2+=s.data.multimodbus_EP8_datasize}if(!0===s.data.multimodbus_EP9){if(0===without_header&&(s.data.multimodbus_EP6_slaveID=e[index2],index2+=1,s.data.multimodbus_EP6_fnctID=e[index2],index2+=1,s.data.multimodbus_EP6_datasize=e[index2],index2+=1),s.data.multimodbus_EP6_payload="",void 0===e[index2])return s;for(x=0;x<s.data.multimodbus_EP6_datasize;x++)1==(u=e[index2+x].toString(16).toUpperCase()).length&&(u="0"+u),s.data.multimodbus_EP6_payload+=u;index2+=s.data.multimodbus_EP6_datasize}}82===clusterdID&0===attributID&&(s.data.active_energy_Wh=a(256*e[index+1]*256+256*e[index+2]+e[index+3],3),s.data.reactive_energy_Varh=a(256*e[index+4]*256+256*e[index+5]+e[index+6],3),s.data.nb_samples=256*e[index+7]+e[index+8],s.data.active_power_W=a(256*e[index+9]+e[index+10],2),s.data.reactive_power_VAR=a(256*e[index+11]+e[index+12],2)),32772===clusterdID&0===attributID&&(1===e[index]&&(s.data.message_type="confirmed"),0===e[index]&&(s.data.message_type="unconfirmed")),32772===clusterdID&1===attributID&&(s.data.nb_retry=e[index]),32772===clusterdID&2===attributID&&(s.data.period_in_minutes=256*e[index+1]+e[index+2],s.data.nb_err_frames=256*e[index+3]+e[index+4]),80===clusterdID&6===attributID&&(index2=index+3,1==(1&e[index+2])&&(s.data.main_or_external_voltage=(256*e[index2]+e[index2+1])/1e3,index2+=2),2==(2&e[index+2])&&(s.data.rechargeable_battery_voltage=(256*e[index2]+e[index2+1])/1e3,index2+=2),4==(4&e[index+2])&&(s.data.disposable_battery_voltage=(256*e[index2]+e[index2+1])/1e3,index2+=2),8==(8&e[index+2])&&(s.data.solar_harvesting_voltage=(256*e[index2]+e[index2+1])/1e3,index2+=2),16==(16&e[index+2])&&(s.data.tic_harvesting_voltage=(256*e[index2]+e[index2+1])/1e3,index2+=2)),32778===clusterdID&0===attributID&&(index2=index,s.data.sum_positive_active_energy_Wh=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.sum_negative_active_energy_Wh=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.sum_positive_reactive_energy_Wh=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.sum_negative_reactive_energy_Wh=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.positive_active_power_W=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.negative_active_power_W=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.positive_reactive_power_W=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4),index2+=4,s.data.negative_reactive_power_W=a(256*e[index2+1]*256*256+256*e[index2+2]*256+256*e[index2+3]+e[index2+4],4)),32784===clusterdID&0===attributID?(s.data.ActiveEnergyWhPhaseA=Int32UnsignedToSigned(256*e[index+1]*256*256+256*e[index+2]*256+256*e[index+3]+e[index+4]),s.data.ReactiveEnergyWhPhaseA=Int32UnsignedToSigned(256*e[index+5]*256*256+256*e[index+6]*256+256*e[index+7]+e[index+8]),s.data.ActiveEnergyWhPhaseB=Int32UnsignedToSigned(256*e[index+9]*256*256+256*e[index+10]*256+256*e[index+11]+e[index+12]),s.data.ReactiveEnergyWhPhaseB=Int32UnsignedToSigned(256*e[index+13]*256*256+256*e[index+14]*256+256*e[index+15]+e[index+16]),s.data.ActiveEnergyWhPhaseC=Int32UnsignedToSigned(256*e[index+17]*256*256+256*e[index+18]*256+256*e[index+19]+e[index+20]),s.data.ReactiveEnergyWhPhaseC=Int32UnsignedToSigned(256*e[index+21]*256*256+256*e[index+22]*256+256*e[index+23]+e[index+24]),s.data.ActiveEnergyWhPhaseABC=Int32UnsignedToSigned(256*e[index+25]*256*256+256*e[index+26]*256+256*e[index+27]+e[index+28]),s.data.ReactiveEnergyWhPhaseABC=Int32UnsignedToSigned(256*e[index+29]*256*256+256*e[index+30]*256+256*e[index+31]+e[index+32])):32784===clusterdID&1===attributID&&(s.data.ActivePowerWPhaseA=Int32UnsignedToSigned(256*e[index+1]*256*256+256*e[index+2]*256+256*e[index+3]+e[index+4]),s.data.ReactivePowerWPhaseA=Int32UnsignedToSigned(256*e[index+5]*256*256+256*e[index+6]*256+256*e[index+7]+e[index+8]),s.data.ActivePowerWPhaseB=Int32UnsignedToSigned(256*e[index+9]*256*256+256*e[index+10]*256+256*e[index+11]+e[index+12]),s.data.ReactivePowerWPhaseB=Int32UnsignedToSigned(256*e[index+13]*256*256+256*e[index+14]*256+256*e[index+15]+e[index+16]),s.data.ActivePowerWPhaseC=Int32UnsignedToSigned(256*e[index+17]*256*256+256*e[index+18]*256+256*e[index+19]+e[index+20]),s.data.ReactivePowerWPhaseC=Int32UnsignedToSigned(256*e[index+21]*256*256+256*e[index+22]*256+256*e[index+23]+e[index+24]),s.data.ActivePowerWPhaseABC=Int32UnsignedToSigned(256*e[index+25]*256*256+256*e[index+26]*256+256*e[index+27]+e[index+28]),s.data.ReactivePowerWPhaseABC=Int32UnsignedToSigned(256*e[index+29]*256*256+256*e[index+30]*256+256*e[index+31]+e[index+32])),32779===clusterdID&0===attributID&&(index2=index,s.data.Vrms=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Irms=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.phase_angle=a(256*e[index2+1]+e[index2+2],2)),32781===clusterdID&0===attributID&&(s.data.VrmsA=a(256*e[index+1]+e[index+2],2)/10,s.data.IrmsA=a(256*e[index+3]+e[index+4],2)/10,s.data.PhaseA=a(256*e[index+5]+e[index+6],2),s.data.VrmsB=a(256*e[index+7]+e[index+8],2)/10,s.data.IrmsB=a(256*e[index+9]+e[index+10],2)/10,s.data.PhaseB=a(256*e[index+11]+e[index+12],2),s.data.VrmsC=a(256*e[index+13]+e[index+14],2)/10,s.data.IrmsC=a(256*e[index+15]+e[index+16],2)/10,s.data.PhaseC=a(256*e[index+17]+e[index+18],2)),32780===clusterdID&0===attributID&&(s.data.Concentration=256*e[index]+e[index+1]),1024===clusterdID&0===attributID&&(s.data.Illuminance=256*e[index]+e[index+1]),1027===clusterdID&0===attributID&&(s.data.Pressure=a(256*e[index]+e[index+1],2)),1030===clusterdID&0===attributID&&(s.data.Occupancy=!!e[index]),32850===clusterdID&0===attributID&&(index2=index,s.data.frequency=(a(256*e[index2+1]+e[index2+2],2)+22232)/1e3,index2+=2,s.data.frequency_min=(a(256*e[index2+1]+e[index2+2],2)+22232)/1e3,index2+=2,s.data.frequency_max=(a(256*e[index2+1]+e[index2+2],2)+22232)/1e3,index2+=2,s.data.Vrms=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Vrms_min=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Vrms_max=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Vpeak=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Vpeak_min=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.Vpeak_max=a(256*e[index2+1]+e[index2+2],2)/10,index2+=2,s.data.over_voltage=a(256*e[index2+1]+e[index2+2],2),index2+=2,s.data.sag_voltage=a(256*e[index2+1]+e[index2+2],2)),32783===clusterdID&&(i=index+1,0===attributID?(o=s.data.Last={},o.NbTriggedAcq=n(e,i,"U32"),i+=4,o.Mean_X_G=n(e,i,"U16")/100,i+=2,o.Max_X_G=n(e,i,"U16")/100,i+=2,o.Dt_X_ms=n(e,i,"U16"),i+=2,o.Mean_Y_G=n(e,i,"U16")/100,i+=2,o.Max_Y_G=n(e,i,"U16")/100,i+=2,o.Dt_Y_ms=n(e,i,"U16"),i+=2,o.Mean_Z_G=n(e,i,"U16")/100,i+=2,o.Max_Z_G=n(e,i,"U16")/100,i+=2,o.Dt_Z_ms=n(e,i,"U16")):1===attributID||2===attributID||3===attributID?(ext=1===attributID?"Stats_X":2===attributID?"Stats_Y":"Stats_Z",o=s.data[ext]={},o.NbAcq=n(e,i,"U16"),i+=2,o.MinMean_G=n(e,i,"U16")/100,i+=2,o.MinMax_G=n(e,i,"U16")/100,i+=2,o.MinDt=n(e,i,"U16"),i+=2,o.MeanMean_G=n(e,i,"U16")/100,i+=2,o.MeanMax_G=n(e,i,"U16")/100,i+=2,o.MeanDt=n(e,i,"U16"),i+=2,o.MaxMean_G=n(e,i,"U16")/100,i+=2,o.MaxMax_G=n(e,i,"U16")/100,i+=2,o.MaxDt=n(e,i,"U16"),i+=2):32768===attributID&&(o=s.data.Params={},o.WaitFreq_Hz=n(e,i,"U16")/10,i+=2,o.AcqFreq_Hz=n(e,i,"U16")/10,i+=2,delay=n(e,i,"U16"),i+=2,32768&delay&&(delay=60*(-32769&delay)),o.NewWaitDelay_s=32768&delay?delay=60*(-32769&delay):delay,o.MaxAcqDuration_ms=n(e,i,"U16"),i+=2,o.Threshold_X_G=n(e,i,"U16")/100,i+=2,o.Threshold_Y_G=n(e,i,"U16")/100,i+=2,o.Threshold_Z_G=n(e,i,"U16")/100,i+=2,o.OverThrsh_Dt_ms=n(e,i,"U16"),i+=2,o.UnderThrsh_Dt_ms=n(e,i,"U16"),i+=2,o.Range_G=n(e,i,"U16")/100,i+=2,o.FilterSmoothCoef=n(e,i,"U8"),i+=1,o.FilterGainCoef=n(e,i,"U8"),i+=1,o=s.data.Params.WorkingModes={},o.SignalEachAcq=128&e[i]?"true":"false",o.RstAftStdRpt_X=1&e[i]?"true":"false",o.RstAftStdRpt_Y=2&e[i]?"true":"false",o.RstAftStdRpt_7=4&e[i]?"true":"false"))}7===cmdID&&(attributID=256*e[6]+e[7],s.zclheader.attributID=r(attributID,4),s.zclheader.status=e[4],s.zclheader.batch=e[5]),9===cmdID&&(attributID=256*e[6]+e[7],s.zclheader.attributID=r(attributID,4),s.zclheader.status=e[4],s.zclheader.batch=e[5],s.zclheader.attribut_type=e[8],s.zclheader.min={},128==(128&e[9])?(s.zclheader.min.value=256*(e[9]-128)+e[10],s.zclheader.min.unity="minutes"):(s.zclheader.min.value=256*e[9]+e[10],s.zclheader.min.unity="seconds"),s.zclheader.max={},128==(128&e[11])?(s.zclheader.max.value=256*(e[11]-128)+e[12],s.zclheader.max.unity="minutes"):(s.zclheader.max.value=256*e[11]+e[12],s.zclheader.max.unity="seconds"),s.lora.payload="")}else s.batch={},s.batch.report="batch";return s}(s,e.fPort);if(1===u.zclheader.alarm&&(l="événement surveillé déclanché"),console.log(u),7===s[1]&&s[0]%2!=0)return{data:{variable:"configure reporting response status",value:u.zclheader.status,date:e.recvTime}};if(9===s[1])return{data:{variable:"read reporting configuration response status",value:u.zclheader.status,date:e.recvTime}};if(1===s[1])return void 0===u.zclheader.data?{data:{variable:"read reporting configuration response status",value:"no data",date:e.recvTime}}:{data:{variable:"read reporting configuration response status",value:u.zclheader.data,date:e.recvTime}};if(void 0!==u.zclheader){if(void 0!==t){let a=u.zclheader.endpoint,i=Object.keys(u.data)[0];return{data:{variable:t[i][a],value:u.data[i],date:e.recvTime},type:"standard",warning:l}}{let t=Object.keys(u.data)[0];return{data:{variable:t,value:u.data[t],date:e.recvTime},type:"standard",warning:l}}}return{type:u.batch.report,payload:u.lora.payload}}(e,s),x=u.payload;if("batch"!==u.type)return{data:u.data,warnings:[u.warning]};{let e={batch1:t[0],batch2:t[1],payload:x,date:l};try{let t=function(e){let t=e.date,a=I(e.batch1,e.batch2,e.payload,t);console.log(a);let i=[];for(let e=0;e<a.dataset.length;e++){let t=a.dataset[e],d={variable:t.data.label_name,value:t.data.value,date:t.data_absolute_timestamp};i.push(d)}return i}(e);return{data:t,warnings:[]}}catch(e){return{error:e.message,warnings:[]}}}}catch(e){return{error:e.message,warnings:[]}}}let w=[2,[{taglbl:0,resol:10,sampletype:7,lblname:"temperature",divide:100},{taglbl:1,resol:100,sampletype:6,lblname:"humidity",divide:100},{taglbl:2,resol:1,sampletype:6,lblname:"battery_voltage",divide:1e3},{taglbl:3,resol:1,sampletype:1,lblname:"open_case",divide:1}]],N=process.argv.slice(2),T=[];T=function(e){let t=[];for(let a=0;a<e.length;a+=2)t.push(parseInt(e.substring(a,a+2),16));return t}(N[1]);let M=N[2],C={bytes:T,fPort:Number(N[0]),recvTime:M};console.log(C);let A=function(e){return result=U(e,w)}(C);console.log(A)}},t={};!function a(i){var d=t[i];if(void 0!==d)return d.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,a),n.exports}(10)})();